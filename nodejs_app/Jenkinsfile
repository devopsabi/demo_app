pipeline {
        agent any
        
        stages {
        
            stage('checkout_nodejs_app') {
            when {expression { params.project_name == 'nodejs' }}
                steps {
                    git branch:"${BRANCH}", url: 'https://github.com/devopsabi/demo_app.git', credentialsId:'git_hub_id'
                    sh "ls -lat"
                }
    
            }

    


         stage('build docker image nodejs_app'){
                steps {
                    script{
                        withDockerRegistry(url:'https://hub.docker.com',credentialsId:'docker_hub_id'){
                            docker.build('https://hub.docker.com/repository/docker/devopsabi/demo_app:'+currentBuild.number).push()
                           }
                    }
                }
            }
    }
}
